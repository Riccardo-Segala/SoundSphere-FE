<div class="container my-5">
    <h1>Il tuo carrello</h1>

    <div class="row">

        <div class="col-lg-8">

            <div *ngFor="let c of carrello" class="d-flex align-items-start py-4 border-bottom cart-card">

                <img src="http://localhost:8080{{c.prodotto.pathImmagine}}" alt="{{ c.prodotto?.nome }}" class="me-3" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px;">
                <div class="flex-grow-1">
                    <h5 class="mb-1">
                        <strong class="me-2">{{ c.prodotto?.marca }}</strong>{{ c.prodotto?.nome }}
                    </h5>
                    <div class="mt-5">
                        <button class="btn align-items-center" (click)="rimuovi(c.prodotto.id)">
                            üóëÔ∏è Rimuovi
                        </button>
                    </div>
                </div>

                <div class="text-end">
                    <!-- nowrap forze gli elementi a rimanere su una riga-->
                    <div class="text-nowrap" *ngIf="isDiscounted()">
                        <!-- modifica mb per mantenere circa lo stesso layout sia con che senza costo giornaliero -->
                        <h5 [class]="isAdmin() ? 'mb-2' : 'mb-4'">{{ c.prodotto?.prezzo | currency:'EUR' }}</h5>
                        <h5 *ngIf="isAdmin()" class="mb-2 fw-light">{{ c.prodotto?.costoGiornaliero | currency:'EUR' }}/gg</h5>
                    </div>

                    <div class="quantity-selector">
                        <div class="quantity-controls">
                            <button type="button" (click)="decrementaQuantita(c)" [disabled]="c.quantita <= 1" class="quantity-btn">-</button>
                            <input id="quantita-carrello" type="number" min="1" name="quantita-carrello" [(ngModel)]="c.quantita" (blur)="updateCart(c)" class="quantity-input">
                            <button type="button" (click)="incrementaQuantita(c)" class="quantity-btn">+</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="d-flex align-items-center p-3 mt-4 border rounded">
                <span class="fs-2 me-3">üöö</span>
                <div class="flex-grow-1">
                    <div class="text-muted">Paese di spedizione:</div>
                    <strong>Italy</strong>
                </div>
                <div class="text-end">
                    <div class="text-muted">Costi di spedizione</div>
                    {{ calcolaSpedizione() | currency:'EUR' }}
                </div>
            </div>

        </div>

        <div class="col-lg-4">
            <div class="card shadow-sm border-0" style="background-color: #f8f9fa;">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-start align-items-end">
                        <h3 class="card-title">Totale</h3>
                        <h3 *ngIf="loggedUser.vantaggio?.sconto" class="ms-2 card-title">{{ totaleScontato | currency:'EUR' }}</h3>
                        <h3 class="ms-2 card-title" [class]="loggedUser.vantaggio?.sconto?'discounted-price small pb-1':''" >{{ totalePrezzo | currency:'EUR' }}</h3>
                    </div>

                    <p class="text-muted mb-4">I prezzi includono l'IVA locale</p>
                    <!-- rounded-pill trasforma i bordi del button in due semicerchi, applica border-radius: 50rem-->
                    <button [disabled]="!carrello || carrello.length === 0" class="btn btn-primary w-100 py-2 rounded-pill" (click)="checkoutOrdine()">
                        PROCEDI ALL'ACQUISTO &rarr;
                    </button>
                    <button *ngIf="canRent()" [disabled]="!carrello || carrello.length === 0" class="btn btn-secondary w-100 rounded-pill mt-2" (click)="checkoutNoleggio()">
                        PROCEDI AL NOLEGGIO &rarr;
                    </button>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div><strong>üöö Consegna standard</strong></div>
                        <div><strong *ngIf="calcolaSpedizione()==0">gratis</strong></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>